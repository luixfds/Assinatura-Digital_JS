<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Campo de Assinatura</title>
</head>
<body style="" id="topo">
    
    <button onclick="limpa()">limpa</button>
    <div id="createPNGButton">
        <button onclick="putImage()">Save as Image</button>        
    </div>
</body>
<script>
window.onload = function () {
plotCanvas('quadro')
    }

function limpa(){
    var d = document.getElementById("topo");
    var d_interno = document.getElementById("quadro");
    var noRemovido = d.removeChild(d_interno);
    plotCanvas('quadro')
    
}
function plotCanvas(el){
    

    var quadro = document.createElement('canvas');
    quadro.id = el;
    quadro.style.backgroundColor = "beige"
    document.body.appendChild(quadro);
    var largura = "900";
    var altura = "600";

    
    var quadro = document.getElementById(el);
    quadro.setAttribute("width", largura);
    quadro.setAttribute("height", altura);

    var ctx = quadro.getContext("2d");
    
    var left = quadro.offsetLeft;
    var top = quadro.offsetTop;
    ctx.fillStyle = "black"
    var desenhando = false;
    quadro.onmousedown = function (evt) {
        ctx.moveTo(evt.clientX - left , evt.clientY - top);
        desenhando = true;
    }
    quadro.onmouseup = function () {
        desenhando = false;
    }
    quadro.onmousemove = function (evt) {
        if (desenhando) {
            ctx.lineTo(evt.clientX - left, evt.clientY - top);
            ctx.stroke();
        }
    }
}


function putImage(){
    var canvas = document.getElementById("quadro");     
    canvas.setAttribute('download', 'ass.png');
    canvas.click();   


    var image = canvas.toDataURL("image/png");
   
    const link = document.createElement('a')
    link.href = image
    link.download = 'assinatura'
    document.body.appendChild(link)
    link.click()
    document.body.removeChild(link)
}  

</script>
</html>
